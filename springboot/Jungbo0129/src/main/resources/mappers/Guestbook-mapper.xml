<!--  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 -->
 
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "E:\DTD\mybatis-3-mapper.dtd">
   
 <mapper namespace="com.rubypaper.guestbook.GuestbookDao">
	<insert id="insert100" parameterType="com.rubypaper.guestbook.GuestbookVO">
	insert into guestbook (idx,name,memo)
	values(guestbookidx.nextval,#{name},#{memo})

	</insert>

   
  <select id="GuestbookList" parameterType="com.rubypaper.guestbook.GuestbookVO"
                    resultType="com.rubypaper.guestbook.GuestbookVO" >
	
	<![CDATA[
	  select rownum, K.* 
	   from 
	     (select rownum as rnum, M.*
	      from (select * from guestbook 	      
	          WHERE 1=1
	         ]]>
	         	
			  <if test="ch1 == 'name' ">
			    and name like '%' || #{ch2} || '%' 	  
			  </if>
			  
			  <if test="ch1 == 'memo' ">
			  and memo like  '%' || #{ch2} || '%' 	   
			  </if>	         
	      
	         <![CDATA[
	       order by idx desc) M
	      where rownum <= #{start}+9) K
	  where RNUM >= #{start}
   ]]>	
    

  </select> 
   <select id="totalcount" parameterType="com.rubypaper.guestbook.GuestbookVO" resultType="int">
        select count(*) from guestbook
	  where 1=1
	
	  <if test="ch1 == 'name' ">
	    and name like  '%' || #{ch2} || '%' 	    
	  </if>
	  
	  <if test="ch1 == 'memo' ">
	   and memo like  '%' || #{ch2} || '%' 	  	  
	  </if>
    </select>
 </mapper>